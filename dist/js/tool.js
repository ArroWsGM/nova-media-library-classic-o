!function(t){var e={};function a(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=12)}([function(t,e){t.exports=function(t,e,a,o,n,r){var i,l=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(i=t,l=t.default);var u,c="function"==typeof l?l.options:l;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),a&&(c.functional=!0),n&&(c._scopeId=n),r?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=u):o&&(u=o),u){var d=c.functional,p=d?c.render:c.beforeCreate;d?(c._injectStyles=u,c.render=function(t,e){return u.call(e),p(t,e)}):c.beforeCreate=p?[].concat(p,u):[u]}return{esModule:i,exports:l,options:c}}},function(t,e,a){var o=a(0)(a(2),a(8),!1,null,null,null);t.exports=o.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(3),n=a.n(o);function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},o=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),o.forEach(function(e){i(t,e,a[e])})}return t}function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l=null,s=null;e.default={components:{Popup:n.a},props:{tool:{type:Boolean,default:!1},gallery:{type:Boolean,default:!1}},data:function(){return{bulk:{array:[],is:!1},filter:{title:"",from:"",to:"",step:0},old:{},data:{array:[],full:!1},upload:{count:0,done:0,error:0},popup:null,loading:!1,types:"."+Nova.config.nml_type.join(",.")}},methods:{clearData:function(){this.data={array:[],full:!1},this.filter.step=0},clearUpload:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.upload={count:t,done:0,error:0}},doSearch:function(){var t=this;JSON.stringify(this.filter)!==JSON.stringify(this.old)&&(this.old=r({},this.filter),clearTimeout(s),s=setTimeout(function(){t.clearData(),t.get()},1e3))},updateDate:function(t,e){this.filter[e]=t,this.doSearch()},get:function(){var t=this;this.data.full=!0,Nova.request().post("/nova-vendor/nova-media-library/get",this.filter).then(function(e){Array.isArray(e.data)&&(t.data.array=t.data.array.concat(e.data)),t.data.full=e.data.length<1}).catch(function(){})},loader:function(){this.filter.step++,this.old.step++,this.get()},scroller:function(){if(!this.data.full&&!this.loading)try{window.innerHeight+window.scrollY>=document.body.offsetHeight&&this.loader()}catch(t){console.error("Your browser does not support some features for automatic file downloads.")}},selectFiles:function(t){if(t.target.files.length){for(var e in this.loading=!0,this.clearUpload(t.target.files.length),t.target.files)isNaN(parseInt(e))||this.uploadFile(t.target.files[e],e);document.getElementById("nml_upload").value=null}},uploadFile:function(t,e){var a=this,o=new FormData;o.append("file",t),o.append("num",e),Nova.request().post("/nova-vendor/nova-media-library/upload",o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){if(t.data.status)a.upload.done++;else{var e=t.data.error?t.data.error:"No file has been uploaded.";a.$toasted.show(e,{type:"error"})}a.uploadCheck()}).catch(function(){a.upload.error++,a.uploadCheck()})},uploadCheck:function(){this.upload.count-=1,this.upload.count<1&&(this.loading=!1,this.$toasted.show("Uploaded files: "+this.upload.done,{type:"success"}),this.upload.error>0&&this.$toasted.show("Uploaded files with error: "+this.upload.error,{type:"error"}),this.upload.done>0&&(this.clearData(),this.get()))},deleteFiles:function(t){var e=this;t.length&&confirm("Delete selected?")&&(this.loading=!0,Nova.request().post("/nova-vendor/nova-media-library/delete",{ids:t}).then(function(t){t.data.status?(e.popup=null,e.bulk.array=[],e.clearData(),e.get()):e.$toasted.show("No file has been deleted.",{type:"error"}),e.loading=!1}).catch(function(){e.loading=!1,e.$toasted.show("Something went wrong.",{type:"error"})}))},changeBulk:function(){this.bulk.is&&(this.bulk.array=[]),this.bulk.is=!this.bulk.is},bulkAll:function(){var t=this;this.bulk.array.length===this.data.array.length?this.bulk.array=[]:(this.bulk.array=[],this.data.array.forEach(function(e){return t.bulk.array.push(e.id)}))},pushFiles:function(){for(var t=this.bulk.array,e=t.length,a=this.data.array,o=[],n=0;n<a.length&&!(t.includes(a[n].id)&&(o.push(a[n].image.url),--e<1));n++);Nova.$emit("nml-select-files",o)},clickCard:function(t){var e=this;if(this.bulk.is)this.bulk.array.includes(t.id)?this.bulk.array=this.bulk.array.filter(function(e){return e!==t.id}).slice():this.bulk.array.push(t.id);else{if(!this.tool)return void Nova.$emit("nml-select-file",t.image.url);this.popup=null,Nova.request().get("/nova-vendor/nova-media-library/single?id="+t.id).then(function(t){t.data.id?e.popup=t.data:e.$toasted.show("Something went wrong, try again.",{type:"error"})}).catch(function(){})}}},created:function(){"onwheel"in document&&(l="wheel"),"onmousewheel"in document&&(l="mousewheel"),this.old=r({},this.filter),this.get(),this.tool&&document.addEventListener(l,this.scroller)},beforeDestroy:function(){this.tool&&document.removeEventListener(l,this.scroller)}}},function(t,e,a){var o=a(0)(a(4),a(7),!1,null,null,null);t.exports=o.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(5);a.n(o);e.default={directives:{copy:o.copy},methods:{error:function(){this.$toasted.show("Something went wrong.",{type:"error"})},update:function(){var t=this;this.$parent.loading=!0,Nova.request().post("/nova-vendor/nova-media-library/update",{id:this.$parent.popup.id,title:this.$parent.popup.title}).then(function(e){e.data.status?(t.$toasted.show("Successfully updated.",{type:"success"}),t.$parent.popup=null):t.error(),t.$parent.loading=!1}).catch(function(){t.$parent.loading=!1,t.error()})},onCopy:function(){this.$toasted.show("URL has been copied",{type:"success"})}},created:function(){document.body.classList.add("overflow-hidden")},beforeDestroy:function(){document.body.classList.remove("overflow-hidden")}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,n=(o=a(6))&&"object"==typeof o&&"default"in o?o.default:o,r={bind:function(t,e){var a=e.value;if("callback"===e.arg)t.$copyCallback=a;else{t.$copyValue=a;var o=function(){n(t.$copyValue),t.$copyCallback&&t.$copyCallback(t.$copyValue)};t.addEventListener("click",o),t.$destroyCopy=function(){return t.removeEventListener("click",o)}}},unbind:function(t){t.$destroyCopy()},componentUpdated:function(t,e){var a=e.value;"callback"===e.arg?t.$copyCallback=a:t.$copyValue=a}},i=function(t){t.directive("copy",r)};"undefined"!=typeof window&&window.Vue&&i(window.Vue),e.copy=r,e.default=i},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.contain="strict",e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="12pt";var a=getSelection(),o=!1;a.rangeCount>0&&(o=a.getRangeAt(0)),document.body.appendChild(e),e.select(),e.selectionStart=0,e.selectionEnd=t.length;var n=!1;try{n=document.execCommand("copy")}catch(t){}return document.body.removeChild(e),o&&(a.removeAllRanges(),a.addRange(o)),n}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup fixed pin z-20 py-view bg-primary-70% overflow-y-auto"},[a("div",{staticClass:"bg-white p-8 rounded-lg shadow-lg m-auto"},[a("button",{staticClass:"close select-none",attrs:{type:"button"},on:{click:function(e){t.$parent.popup=null}}},[t._v("Ã—")]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80"},[t._v("ID")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[t._v(t._s(t.$parent.popup.id))])]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80"},[t._v("Created")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[t._v(t._s(t.$parent.popup.created))])]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80"},[t._v("Type")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[t._v(t._s(t.$parent.popup.type))])]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80"},[t._v("Size")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[t._v(t._s(t.$parent.popup.size))])]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80 leading-loose"},[t._v("Title")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.$parent.popup.title,expression:"$parent.popup.title"}],staticClass:"form-control form-input w-full shadow-md",domProps:{value:t.$parent.popup.title},on:{input:function(e){e.target.composing||t.$set(t.$parent.popup,"title",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"flex border-b border-40"},[a("div",{staticClass:"w-1/4 py-4 font-bold text-80"},[t._v("URL")]),t._v(" "),a("div",{staticClass:"w-3/4 py-4"},[a("a",{staticClass:"text-primary font-bold no-underline",attrs:{href:t.$parent.popup.url,target:"_blank"}},[t._v("Open")]),t._v(" "),a("button",{directives:[{name:"copy",rawName:"v-copy",value:t.$parent.popup.url,expression:"$parent.popup.url"},{name:"copy",rawName:"v-copy:callback",value:t.onCopy,expression:"onCopy",arg:"callback"}],staticClass:"text-80 font-bold no-underline float-right",attrs:{type:"button"}},[t._v("Copy")])])]),t._v(" "),a("div",{staticClass:"flex mt-6"},[a("button",{staticClass:"btn-default btn-primary cursor-pointer mr-6 shadow-md",attrs:{type:"button"},on:{click:t.update}},[t._v("\n        Update Title\n      ")]),t._v(" "),a("button",{staticClass:"btn-default btn-danger cursor-pointer ml-auto shadow-md",attrs:{type:"button"},on:{click:function(e){return t.$parent.deleteFiles([t.$parent.popup.id])}}},[t._v("\n        Delete File\n      ")])])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"nml-tool"}},[a("heading",{staticClass:"mb-6"},[t._v("Media Library")]),t._v(" "),a("div",{staticClass:"flex mb-6"},[t.tool||t.gallery?a("checkbox-with-label",{staticClass:"mr-6",attrs:{checked:t.bulk.is},on:{change:t.changeBulk}},[t._v("Bulk select")]):t._e(),t._v(" "),t.bulk.is?a("button",{staticClass:"form-file-btn btn-default btn-primary cursor-pointer shadow-md mr-6",attrs:{type:"button"},on:{click:t.bulkAll}},[t._v("\n      Select all\n    ")]):t._e(),t._v(" "),t.bulk.is&&t.bulk.array.length?a("button",{staticClass:"form-file-btn btn-default btn-danger cursor-pointer shadow-md",attrs:{type:"button"},on:{click:function(e){return t.deleteFiles(t.bulk.array)}}},[t._v("\n      Delete selected: "+t._s(t.bulk.array.length)+"\n    ")]):t._e(),t._v(" "),!t.tool&&t.bulk.is&&t.bulk.array.length?a("button",{staticClass:"form-file-btn btn-default text-white bg-success cursor-pointer shadow-md ml-6",attrs:{type:"button"},on:{click:t.pushFiles}},[t._v("\n      Add to Gallery: "+t._s(t.bulk.array.length)+"\n    ")]):t._e(),t._v(" "),a("label",{staticClass:"form-file-btn btn btn-default btn-primary cursor-pointer shadow-md ml-auto"},[a("input",{staticClass:"form-file-input",attrs:{id:"nml_upload",accept:t.types,type:"file",multiple:""},on:{change:t.selectFiles}}),t._v("\n      Upload Files\n    ")])],1),t._v(" "),a("div",{staticClass:"flex mb-6"},[a("div",{staticClass:"relative mr-4"},[a("icon",{staticClass:"absolute search-icon-center ml-3 text-70",attrs:{type:"search"}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.title,expression:"filter.title"}],staticClass:"form-control form-input w-search pl-search shadow-md",attrs:{type:"search",placeholder:"Search by Title"},domProps:{value:t.filter.title},on:{input:[function(e){e.target.composing||t.$set(t.filter,"title",e.target.value)},function(e){return t.doSearch()}]}})],1),t._v(" "),a("date-time-picker",{staticClass:"form-control form-input shadow-md mr-4",attrs:{autocomplete:"off",placeholder:"Upload date from",dateFormat:"Y-m-d",firstDayOfWeek:1,"enable-time":!1},on:{change:function(e){return t.updateDate(e,"from")}}}),t._v(" "),a("date-time-picker",{staticClass:"form-control form-input shadow-md mr-4",attrs:{autocomplete:"off",placeholder:"Upload date to",dateFormat:"Y-m-d",firstDayOfWeek:1,"enable-time":!1},on:{change:function(e){return t.updateDate(e,"to")}}})],1),t._v(" "),a("div",{staticClass:"flex flex-wrap -mx-1 pb-4 card-array"},t._l(t.data.array,function(e,o){return a("div",{key:"nml-"+o,staticClass:"item px-1 mb-2 w-1/6 cursor-pointer"},[a("div",{staticClass:"card shadow-md",style:{backgroundImage:"url("+e.image.url+")"},on:{click:function(a){return t.clickCard(e)}}},[t.bulk.is?a("checkbox",{attrs:{checked:t.bulk.array.includes(e.id)}}):t._e()],1)])}),0),t._v(" "),t.loading||t.data.full?t._e():[a("button",{staticClass:"form-file-btn btn-default btn-primary cursor-pointer mt-8 m-auto block shadow-md",attrs:{type:"button"},on:{click:t.loader}},[t._v("\n      "+t._s(t.tool?"Click if auto load is not working":"Load More")+"\n    ")]),t._v(" "),t.tool?a("div",{staticClass:"help-text help-text pb-4 mt-2 m-auto block text-center"},[t._v("\n      Scroll down to automatically download files or click the button above\n    ")]):t._e()],t._v(" "),t.loading?a("div",{staticClass:"fixed pin z-30 bg-white-50%"},[a("loading-view")],1):t._e(),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.popup?a("Popup"):t._e()],1)],2)},staticRenderFns:[]}},,,,function(t,e,a){a(13),a(17),t.exports=a(18)},function(t,e,a){Nova.booting(function(t,e){e.addRoutes([{name:"nova-media-library",path:"/media-library",component:a(14)}])})},function(t,e,a){var o=a(0)(a(15),a(16),!1,null,null,null);t.exports=o.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(1),n=a.n(o);e.default={components:{Library:n.a}}},function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("Library",{attrs:{tool:!0}})},staticRenderFns:[]}},function(t,e){},function(t,e){}]);